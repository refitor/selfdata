/*!
 * @form-create/component-ivu-group v2.5.17
 * (c) 2018-2022 xaboy
 * Github https://github.com/xaboy/form-create with @form-create/component-ivu-group
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).FcGroup=t()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t,n=1;n<arguments.length;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)}var t=["attrs","props","domProps"],n=["class","style","directives"],i=["on","nativeOn"],r=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}},o=function(o){return o.reduce(function(o,a){for(var c in a)if(o[c])if(-1!==t.indexOf(c))o[c]=e({},o[c],a[c]);else if(-1!==n.indexOf(c)){var s=o[c]instanceof Array?o[c]:[o[c]],u=a[c]instanceof Array?a[c]:[a[c]];o[c]=s.concat(u)}else if(-1!==i.indexOf(c))for(var l in a[c])if(o[c][l]){var f=o[c][l]instanceof Array?o[c][l]:[o[c][l]],h=a[c][l]instanceof Array?a[c][l]:[a[c][l]];o[c][l]=f.concat(h)}else o[c][l]=a[c][l];else if("hook"==c)for(var d in a[c])o[c][d]=o[c][d]?r(o[c][d],a[c][d]):a[c][d];else o[c]=a[c];else o[c]=a[c];return o},{})};function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var f="fcGroup";function h(e){return{name:f,props:{field:String,rule:[Array,Object],rules:Array,expand:Number,options:Object,formCreateInject:{type:Object,required:!0},button:{type:Boolean,default:!0},max:{type:Number,default:0},min:{type:Number,default:0},value:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},syncDisabled:{type:Boolean,default:!0},fontSize:{type:Number,default:28},onBeforeRemove:{type:Function,default:function(){}},onBeforeAdd:{type:Function,default:function(){}}},data:function(){return{len:0,cacheRule:{},cacheValue:{},type:void 0}},computed:{formRule:function(){return this.rule?Array.isArray(this.rule)?this.rule:[this.rule]:this.rules?this.rules:[]}},watch:{disabled:function(e){if(this.syncDisabled){var t=this.cacheRule;Object.keys(t).forEach(function(n){t[n].$f.disabled(e)})}},expand:function(e){var t=e-this.value.length;t>0&&this.expandRule(t)},value:function(e){var t=this;e=e||[];var n=Object.keys(this.cacheRule),i=n.length,r=i-e.length;if(r<0){for(var o=r;o<0;o++)this.addRule(e.length+o);for(var a=0;a<i;a++)this.setValue(n[a],e[a])}else{if(r>0){for(var c=0;c<r;c++)this.removeRule(n[i-c-1]);this.subForm()}e.forEach(function(i,r){t.setValue(n[r],e[r])})}}},methods:{_value:function(e){return e&&(t=e,n=this.field,{}.hasOwnProperty.call(t,n))?e[this.field]:e;var t,n},cache:function(e,t){this.cacheValue[e]=JSON.stringify(t)},input:function(e){this.$emit("input",e),this.$emit("change",e)},formData:function(e,t){var n=this,i=this.cacheRule,r=Object.keys(i);if(r.filter(function(e){return i[e].$f}).length===r.length){var o=r.map(function(i){var r=e===i?t:s({},n.cacheRule[i].$f.form),o=n.field?r[n.field]||null:r;return n.cache(i,o),o});this.input(o)}},setValue:function(e,t){var n=this.field,i=this.cacheRule[e].$f;n&&(t=a({},n,this._value(t))),this.cacheValue[e]!==JSON.stringify(n?t[n]:t)&&(this.cache(e,t),i.coverValue(t||{}))},addRule:function(e,t){var n=this,i=this.formCreateInject.form.copyRules(this.formRule),r=this.options?s({},this.options):{submitBtn:!1,resetBtn:!1};r.formData=this.field?a({},this.field,this._value(this.value[e])):this.value[e]||{},this.$set(this.cacheRule,++this.len,{rule:i,options:r}),t&&this.$nextTick(function(){return n.$emit("add",i,Object.keys(n.cacheRule).length-1)})},add$f:function(e,t,n){var i=this;this.cacheRule[t].$f=n,this.subForm(),this.$nextTick(function(){i.syncDisabled&&n.disabled(i.disabled),i.$emit("itemMounted",n,Object.keys(i.cacheRule).indexOf(t))})},subForm:function(){var e=this;this.formCreateInject.subForm(Object.keys(this.cacheRule).map(function(t){return e.cacheRule[t].$f}))},removeRule:function(e,t){var n=this,i=Object.keys(this.cacheRule).indexOf(e);this.$delete(this.cacheRule,e),this.$delete(this.cacheValue,e),t&&this.$nextTick(function(){return n.$emit("remove",i)})},add:function(e){this.disabled||!1===this.onBeforeAdd(this.value)||this.addRule(e,!0)},del:function(e,t){this.disabled||!1===this.onBeforeRemove(this.value,e)||(this.removeRule(t,!0),this.subForm(),this.value.splice(e,1),this.input(this.value))},addIcon:function(t){return(0,this.$createElement)("Icon",{key:"a".concat(t),attrs:{type:e.addIcon},style:"font-size:".concat(this.fontSize,"px;cursor:").concat(this.disabled?"not-allowed;color:#c9cdd4":"pointer;color:#000"),on:{click:this.add}})},delIcon:function(t,n){var i=this;return(0,this.$createElement)("Icon",{key:"d".concat(n),attrs:{type:e.removeIcon},style:"font-size:".concat(this.fontSize,"px;cursor:").concat(this.disabled?"not-allowed;color:#c9cdd4":"pointer",";"),on:{click:function(){return i.del(t,n)}}})},makeIcon:function(e,t,n){var i=this;return this.$scopedSlots.button?this.$scopedSlots.button({total:e,index:t,vm:this,key:n,del:function(){return i.del(t,n)},add:this.add}):0===t?[0!==this.max&&e>=this.max?null:this.addIcon(n),0===this.min||e>this.min?this.delIcon(t,n):null]:t>=this.min?this.delIcon(t,n):void 0},emitEvent:function(e,t,n,i){this.$emit.apply(this,[e].concat(u(t),[this.cacheRule[i].$f,n]))},expandRule:function(e){for(var t=0;t<e;t++)this.value.push(this.field?null:{})}},created:function(){this.type=this.formCreateInject.form.$form();var e=(this.expand||0)-this.value.length;e>0&&this.expandRule(e);for(var t=0;t<this.value.length;t++)this.addRule(t)},render:function(){var t=this,n=arguments[0],i=Object.keys(this.cacheRule),r=this.button,a=this.type;return 0===i.length?this.$scopedSlots.default?this.$scopedSlots.default({vm:this,add:this.add}):n("Icon",{key:"a_def",attrs:{type:e.addIcon},style:"font-size:".concat(this.fontSize,"px;vertical-align:middle;cursor:").concat(this.disabled?"not-allowed;color:#c9cdd4":"pointer",";"),on:{click:this.add}}):n("div",{key:"con"},[i.map(function(e,c){var s=t.cacheRule[e],u=s.rule,l=s.options;return n("Row",{attrs:{align:"middle",type:"flex"},key:e,style:"border-bottom:1px dashed #dcdee2;margin-bottom:10px;"},[n("Col",{attrs:{span:r?20:24}},[n("FormItem",[n(a,o([{key:e},{on:{"update:value":function(n){return t.formData(e,n)},"emit-event":function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return t.emitEvent(n,r,c,e)},input:function(n){return t.add$f(c,e,n)}}},{attrs:{rule:u,option:l,extendOption:!0}}]))])]),r?n("Col",{attrs:{span:2,pull:1,push:1}},[t.makeIcon(i.length,c,e)]):null])})])}}}var d=h({removeIcon:"ios-remove-circle-outline",addIcon:"ios-add-circle-outline"});return d.v2=h({addIcon:"ios-plus-outline",removeIcon:"ios-minus-outline"}),d});
//# sourceMappingURL=index.js.map
