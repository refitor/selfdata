{"remainingRequest":"/home/jery/Desktop/dev/rshub/product/rsapp/selfdata/web/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/home/jery/Desktop/dev/rshub/product/rsapp/selfdata/web/src/pages/auth.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jery/Desktop/dev/rshub/product/rsapp/selfdata/web/src/pages/auth.vue","mtime":1653311932831},{"path":"/home/jery/Desktop/dev/rshub/product/rsapp/selfdata/web/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":1651945230823},{"path":"/home/jery/Desktop/dev/rshub/product/rsapp/selfdata/web/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":1651945387533}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCglpbXBvcnQge3dlYlJlc3BvbnNlfSBmcm9tICcuLi90b29sY2hhaW4vaGVscC5qcyc7CiAgICBleHBvcnQgZGVmYXVsdCB7CgkJaW5qZWN0OiBbInJlbG9hZCJdLAogICAgICAgIGRhdGEgKCkgewogICAgICAgICAgICByZXR1cm4gewoJCQkJdXNlcjogbnVsbCwKCQkJCXVzZXJJRDogJycsCgkJCQlhdXRoTWFpbDogJycsCgkJCQlhdXRoQ29kZTogJycsCgkJCQlzaG93TW9kYWw6IGZhbHNlLAoJCQkJYXV0aE1vZGFsOiBmYWxzZSwKCQkJCWF1dGhCeVB3ZDogZmFsc2UsCgkJCQkKCQkJCXFyY29kZUF1dGg6IGZhbHNlLAoJCQkJanVzdFZlcmlmeUVtYWlsOiBmYWxzZSwKCQkJCQoJCQkJaXNQYWdlOiBmYWxzZSwKCQkJCXFyY29kZUltZzogJycsCgkJCQljb2RldGltZXI6IG51bGwsCgkJCQlyZWRpcmVjdFVybDogJy8nLAogICAgICAgICAgICB9CgkJfSwKCQlwcm9wczogewoJCQlvbkF1dGhTdWNjZXNzZWQ6IHsKCQkJCXR5cGU6IEZ1bmN0aW9uLAoJCQkJZGVmYXVsdDogbnVsbAoJCQl9LAoJCQlvblVzZXJPZmY6IHsKCQkJCXR5cGU6IEZ1bmN0aW9uLAoJCQkJZGVmYXVsdDogbnVsbAoJCQl9LAoJCX0sCiAgICAgICAgbW91bnRlZDpmdW5jdGlvbigpewoJCQl2YXIgY2FjaGVFbWFpbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhdXRoTWFpbCcpOwoJCQlpZiAoY2FjaGVFbWFpbCAhPT0gdW5kZWZpbmVkICYmIGNhY2hlRW1haWwgIT09IG51bGwgJiYgdHlwZW9mKGNhY2hlRW1haWwpID09PSAnc3RyaW5nJykgewoJCQkJdGhpcy5hdXRoTWFpbCA9IGNhY2hlRW1haWw7CgkJCQljb25zb2xlLmxvZyh0aGlzLmF1dGhNYWlsKQoJCQl9CgkJCWNvbnNvbGUubG9nKHRoaXMuJHJvdXRlKQoJCQkKCQkJaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJy9hdXRoJykgPiAtMSkgewoJCQkJdGhpcy5pc1BhZ2UgPSB0cnVlOwoJCQkJaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LnJlZGlyZWN0VXJsICE9PSB1bmRlZmluZWQpIHRoaXMucmVkaXJlY3RVcmwgPSB0aGlzLiRyb3V0ZS5xdWVyeS5yZWRpcmVjdFVybDsKCQkJCXRoaXMucnVuTW9kYWwodGhpcy4kcm91dGUucXVlcnkuZW1haWwpCgkJCX0KICAgICAgICB9LAogICAgICAgIG1ldGhvZHM6IHsKCQkJZ2V0VXNlcigpIHsKCQkJCXJldHVybiB0aGlzLnVzZXI7CgkJCX0sCgkJCXJ1bk1vZGFsKGVtYWlsKSB7CgkJCQlpZiAoZW1haWwgIT09IHVuZGVmaW5lZCAmJiBlbWFpbCAhPT0gbnVsbCAmJiBlbWFpbCAhPT0gJycpIHRoaXMuanVzdFZlcmlmeUVtYWlsID0gdHJ1ZTsKCQkJCWlmICh0aGlzLmF1dGhNYWlsID09PSAnJykgdGhpcy5hdXRoTWFpbCA9IGVtYWlsOwoJCQkJdGhpcy5zaG93TW9kYWwgPSB0cnVlOwoJCQkJdGhpcy5hdXRoTW9kYWwgPSB0cnVlOwoJCQl9LAoJCQljYW5jZWxBdXRoKGJTdWNjZXNzZWQpIHsKCQkJCWlmICh0aGlzLmlzUGFnZSA9PT0gdHJ1ZSkgewoJCQkJCWlmIChiU3VjY2Vzc2VkID09PSB0cnVlKSB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHRoaXMucmVkaXJlY3RVcmw7CgkJCQl9IGVsc2UgewoJCQkJCWlmICh0aGlzLmp1c3RWZXJpZnlFbWFpbCA9PT0gZmFsc2UpIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdpc0xvZ2luJyk7CgkJCQkJaWYgKHRoaXMuY29kZXRpbWVyICE9PSBudWxsKSBjbGVhckludGVydmFsKHRoaXMuY29kZXRpbWVyKTsKCQkJCQl0aGlzLmp1c3RWZXJpZnlFbWFpbCA9IGZhbHNlOwoJCQkJCXRoaXMuc2hvd01vZGFsID0gZmFsc2U7CgkJCQkJdGhpcy5hdXRoTW9kYWwgPSBmYWxzZTsKCQkJCQl0aGlzLmF1dGhDb2RlID0gJyc7CgkJCQl9CgkJCX0sCgkJCXVwZGF0ZVVzZXIocmVzcG9uc2UpIHsKCQkJCWxldCBhdXRoUmVzdWx0ID0gZmFsc2U7CgkJCQlpZiAocmVzcG9uc2UgPT09IG51bGwpIHsKCQkJCQl0aGlzLnVzZXIgPSBudWxsOwoJCQkJCWxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhdXRoTWFpbCcpOwoJCQkJCWlmICh0aGlzLm9uVXNlck9mZiAhPT0gbnVsbCAmJiB0aGlzLm9uVXNlck9mZiAhPT0gdW5kZWZpbmVkKSB0aGlzLm9uVXNlck9mZihyZXNwb25zZSk7CgkJCQl9IGVsc2UgewoJCQkJCWF1dGhSZXN1bHQgPSB0cnVlOwoJCQkJCXRoaXMudXNlciA9IHJlc3BvbnNlLmRhdGFbJ0RhdGEnXTsKCQkJCQlsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaXNMb2dpbicsICd0cnVlJyk7CgkJCQkJbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2F1dGhNYWlsJywgdGhpcy5hdXRoTWFpbCk7CgkJCQkJaWYgKHRoaXMub25BdXRoU3VjY2Vzc2VkICE9PSBudWxsICYmIHRoaXMub25BdXRoU3VjY2Vzc2VkICE9PSB1bmRlZmluZWQpIHRoaXMub25BdXRoU3VjY2Vzc2VkKHJlc3BvbnNlKTsKCQkJCX0KCQkJCXRoaXMuY2FuY2VsQXV0aChhdXRoUmVzdWx0KTsKCQkJfSwKCQkJLy8g6L+Z6YeM55qEb25Vc2VyT25saW5l5ZKMb25Vc2VyT2Zm5LuF55So5LqO5Li05pe25Zue6LCDCgkJCWNoZWNrU3RhdHVzKG9uQXV0aFN1Y2Nlc3NlZCwgb25Vc2VyT2ZmLCByYW5kb20pIHsKCQkJCWxldCBzZWxmID0gdGhpczsKCQkJCWxldCBnZXRVcmwgPSAnL2FwaS91c2VyL3N0YXR1cyc7CgkJCQlpZiAocmFuZG9tICE9PSB1bmRlZmluZWQgJiYgcmFuZG9tICE9PSBudWxsICYmIHJhbmRvbSAhPT0gJycpIGdldFVybCA9IGdldFVybCArICc/cmFuZG9tPScgKyByYW5kb207CgkJCQl0aGlzLmh0dHBHZXQoZ2V0VXJsLCBmdW5jdGlvbihyZXNwb25zZSl7CgkJCQkJd2ViUmVzcG9uc2UocmVzcG9uc2UsIGZ1bmN0aW9uKGVycil7CgkJCQkJCWNvbnNvbGUubG9nKGVycikKCQkJCQkJc2VsZi4kTWVzc2FnZS5lcnJvcihlcnIpCgkJCQkJCXNlbGYudXBkYXRlVXNlcihudWxsKTsKCQkJCQkJaWYgKG9uVXNlck9mZiAhPT0gbnVsbCAmJiBvblVzZXJPZmYgIT09IHVuZGVmaW5lZCkgb25Vc2VyT2ZmKHJlc3BvbnNlKTsKCQkJCQl9LCBmdW5jdGlvbihyZXNwb25zZSl7CgkJCQkJCXNlbGYudXBkYXRlVXNlcihyZXNwb25zZSk7CgkJCQkJCWlmIChvbkF1dGhTdWNjZXNzZWQgIT09IG51bGwgJiYgb25BdXRoU3VjY2Vzc2VkICE9PSB1bmRlZmluZWQpIG9uQXV0aFN1Y2Nlc3NlZChyZXNwb25zZSk7CgkJCQkJfSkKCQkJCX0pCgkJCX0sCgkJCWxvZ291dFVzZXIoKSB7CgkJCQlsZXQgc2VsZiA9IHRoaXM7CgkJCQl0aGlzLmh0dHBHZXQoJy9hcGkvdXNlci9sb2dvdXQnLCBmdW5jdGlvbihyZXNwb25zZSl7CgkJCQkJc2VsZi51cGRhdGVVc2VyKG51bGwpOwoJCQkJfSwgZnVuY3Rpb24ocmVzcG9uc2UpewoJCQkJCXNlbGYudXBkYXRlVXNlcihudWxsKTsKCQkJCX0pCgkJCX0sCgkJCWluaXRBdXRoKCkgewoJCQkJdGhpcy5hdXRoQnlQd2QgPSBmYWxzZTsKCQkJCXRoaXMucXJjb2RlSW1nID0gJyc7CgkJCX0sCgkJCWF1dGhDb2RlU2VuZCgpIHsKCQkJCWlmICh0aGlzLmNoZWNrQXV0aEVtYWlsKCkgPT09IGZhbHNlKSByZXR1cm47CgoJCQkJbGV0IHRpbWVDb3VudCA9IDA7CgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXV0aEJ0biIpLmRpc2FibGVkID0gdHJ1ZTsKCQkJCWxldCBvbGROYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImF1dGhCdG4iKS5pbm5lckhUTUw7CgkJCQlsZXQgdGltZXIgPSBzZXRJbnRlcnZhbCgoKT0+IHsKCQkJCQlpZiAodGltZUNvdW50IDwgNjAwMDApIHsKCQkJCQkJaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhdXRoQnRuIikgPT09IHVuZGVmaW5lZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXV0aEJ0biIpID09PSBudWxsKSB7CgkJCQkJCQljbGVhckludGVydmFsKHRpbWVyKTsKCQkJCQkJCXJldHVybjsKCQkJCQkJfQoJCQkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXV0aEJ0biIpLmlubmVySFRNTCA9ICg2MDAwMCAtIHRpbWVDb3VudCkgLyAxMDAwICsgJ3MgJyArIHRoaXMuJHQoJ2xhbmcucmV0cnknKQoJCQkJCQl0aW1lQ291bnQgPSB0aW1lQ291bnQgKyAxMDAwOwoJCQkJCQlyZXR1cm4KCQkJCQl9CgkJCQkJY2xlYXJJbnRlcnZhbCh0aW1lcik7CgkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImF1dGhCdG4iKS5kaXNhYmxlZCA9IGZhbHNlOwoJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhdXRoQnRuIikuaW5uZXJIVE1MID0gb2xkTmFtZTsKCQkJCX0sIDEwMDApCgoJCQkJbGV0IHNlbGYgPSB0aGlzOwoJCQkJbGV0IGZvcm1kYXRhID0gbmV3IEZvcm1EYXRhKCk7CgkJCQlmb3JtZGF0YS5hcHBlbmQoJ2tpbmQnLCAnc2VuZCcpOwoJCQkJZm9ybWRhdGEuYXBwZW5kKCdhdXRoSUQnLCB0aGlzLmF1dGhNYWlsKTsKCQkJCXRoaXMuaHR0cFBvc3QoJy9hcGkvdXNlci9hdXRoJywgZm9ybWRhdGEsIGZ1bmN0aW9uKHJlc3BvbnNlKXsKCQkJCQl3ZWJSZXNwb25zZShyZXNwb25zZSwgZnVuY3Rpb24oZXJyKXsKCQkJCQkJc2VsZi4kTWVzc2FnZS5lcnJvcihlcnIpCgkJCQkJfSkKCQkJCX0pCgkJCX0sCgkJCXJ1bkF1dGgoKSB7CgkJCQlpZiAodGhpcy5jaGVja0F1dGhFbWFpbCgpID09PSBmYWxzZSkgcmV0dXJuOwoKCQkJCWxldCBzZWxmID0gdGhpczsKCQkJCWxldCBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpOwoJCQkJbGV0IHBvc3RVcmwgPSAnL2FwaS91c2VyL2F1dGgnOwkJCQkKCQkJCWZvcm1kYXRhLmFwcGVuZCgna2luZCcsICd2ZXJpZnknKTsKCQkJCWZvcm1kYXRhLmFwcGVuZCgnYXV0aElEJywgdGhpcy5hdXRoTWFpbCk7CgkJCQlmb3JtZGF0YS5hcHBlbmQoJ3B3ZCcsIHRoaXMuYXV0aENvZGUpOwoJCQkJZm9ybWRhdGEuYXBwZW5kKCdqdXN0VmVyaWZ5JywgdGhpcy5qdXN0VmVyaWZ5RW1haWwpOwoJCQkJdGhpcy5odHRwUG9zdChwb3N0VXJsLCBmb3JtZGF0YSwgZnVuY3Rpb24ocmVzcG9uc2UpewoJCQkJCXdlYlJlc3BvbnNlKHJlc3BvbnNlLCBmdW5jdGlvbihlcnIpe3NlbGYuJE1lc3NhZ2UuZXJyb3IoZXJyKX0sIHNlbGYuYXV0aFN1Y2Nlc3NlZCkKCQkJCX0pCgkJCX0sCgkJCWF1dGhTdWNjZXNzZWQocmVzcG9uc2UpIHsKCQkJCWNvbnNvbGUubG9nKHJlc3BvbnNlLCB0aGlzLmp1c3RWZXJpZnlFbWFpbCkKCQkJCXRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcyh0aGlzLiR0KCdsYW5nLmF1dGhUaXRsZScpICsgdGhpcy4kdCgnbGFuZy5zdWNjZXNzZWQnKSk7CgkJCQlpZiAodGhpcy5qdXN0VmVyaWZ5RW1haWwgPT09IHRydWUpIHsKCQkJCQlpZiAodGhpcy5jb2RldGltZXIgIT09IG51bGwpIGNsZWFySW50ZXJ2YWwodGhpcy5jb2RldGltZXIpOwoJCQkJCXRoaXMuanVzdFZlcmlmeUVtYWlsID0gZmFsc2U7CgkJCQkJdGhpcy5zaG93TW9kYWwgPSBmYWxzZTsKCQkJCQl0aGlzLmF1dGhNb2RhbCA9IGZhbHNlOwoJCQkJCWlmICh0aGlzLm9uQXV0aFN1Y2Nlc3NlZCAhPT0gbnVsbCAmJiB0aGlzLm9uQXV0aFN1Y2Nlc3NlZCAhPT0gdW5kZWZpbmVkKSB0aGlzLm9uQXV0aFN1Y2Nlc3NlZChyZXNwb25zZSk7CgkJCQkJcmV0dXJuCgkJCQl9CgkJCQl0aGlzLnVwZGF0ZVVzZXIocmVzcG9uc2UpOwoJCQl9LAoJCQljaGVja0F1dGhFbWFpbCgpIHsKCQkJCWxldCBhdXRoTWFpbCA9IHRoaXMuYXV0aE1haWw7CgkJCQlpZiAodGhpcy5hdXRoTWFpbCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuYXV0aE1haWwgPT09IG51bGwpIGF1dGhNYWlsID0gJyc7CgkJCQlsZXQgaXNJbnZhbGlkRW1haWwgPSBhdXRoTWFpbCAhPT0gJycgJiYgYXV0aE1haWwuaW5kZXhPZignQCcpID09PSAtMTsKCQkJCWlmIChhdXRoTWFpbCA9PT0gJycgfHwgaXNJbnZhbGlkRW1haWwpIHsKCQkJCQl0aGlzLiRNZXNzYWdlLmVycm9yKHRoaXMuJHQoJ2xhbmcuaW5wdXRFbWFpbCcpKTsKCQkJCQlyZXR1cm4gZmFsc2UKCQkJCX0KCQkJCXJldHVybiB0cnVlOwoJCQl9LAoJCQlpbml0UVJDb2RlSW1nKCkgewoJCQkJaWYgKHRoaXMuY2hlY2tBdXRoRW1haWwoKSA9PT0gZmFsc2UpIHJldHVybjsKCgkJCQlsZXQgc2VsZiA9IHRoaXM7CgkJCQlsZXQgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKTsKCQkJCWZvcm1kYXRhLmFwcGVuZCgna2luZCcsICdxcmNvZGUnKTsKCQkJCWZvcm1kYXRhLmFwcGVuZCgnYXV0aElEJywgdGhpcy5hdXRoTWFpbCk7CgkJCQl0aGlzLmh0dHBQb3N0KCcvYXBpL3VzZXIvYXV0aCcsIGZvcm1kYXRhLCBmdW5jdGlvbihyZXNwb25zZSl7CgkJCQkJd2ViUmVzcG9uc2UocmVzcG9uc2UsIGZ1bmN0aW9uKGVycil7c2VsZi4kTWVzc2FnZS5lcnJvcihlcnIpfSwgc2VsZi51cGRhdGVRUkNvZGVJbWcpCgkJCQl9KQoJCQl9LAoJCQl1cGRhdGVRUkNvZGVJbWcocmVzcG9uc2UpIHsKCQkJCXRoaXMucXJjb2RlSW1nID0gcmVzcG9uc2UuZGF0YVsnRGF0YSddOwoJCQl9LAoJCQlodHRwR2V0KHVybCwgb25SZXNwb25zZSwgb25QYW5pYykgewoJCQkJdGhpcy4kYXhpb3MuZ2V0KHVybCkKCQkJCS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewoJCQkJCWlmIChvblJlc3BvbnNlICE9PSB1bmRlZmluZWQgJiYgb25SZXNwb25zZSAhPT0gbnVsbCkgb25SZXNwb25zZShyZXNwb25zZSk7CgkJCQl9KQoJCQkJLmNhdGNoKGZ1bmN0aW9uIChyZXNwb25zZSkgewoJCQkJCWlmIChvblBhbmljICE9PSB1bmRlZmluZWQgJiYgb25QYW5pYyAhPT0gbnVsbCkgb25QYW5pYyhyZXNwb25zZSk7CgkJCQl9KTsKCQkJfSwKCQkJaHR0cFBvc3QodXJsLCBmb3JtZGF0YSwgb25SZXNwb25zZSwgb25QYW5pYykgewoJCQkJdGhpcy4kYXhpb3MucG9zdCh1cmwsIGZvcm1kYXRhKQoJCQkJLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CgkJCQkJaWYgKG9uUmVzcG9uc2UgIT09IHVuZGVmaW5lZCAmJiBvblJlc3BvbnNlICE9PSBudWxsKSBvblJlc3BvbnNlKHJlc3BvbnNlKTsKCQkJCX0pCgkJCQkuY2F0Y2goZnVuY3Rpb24gKHJlc3BvbnNlKSB7CgkJCQkJaWYgKG9uUGFuaWMgIT09IHVuZGVmaW5lZCAmJiBvblBhbmljICE9PSBudWxsKSBvblBhbmljKHJlc3BvbnNlKTsKCQkJCX0pOwoJCQl9CiAgICAgICAgfQogICAgfQogICAg"},{"version":3,"sources":["auth.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"auth.vue","sourceRoot":"src/pages","sourcesContent":["<style lang=\"less\">\n.authModal {\n    background: url('../../public/assets/img/login.jpg') center center;\n    background-size: cover;\n}\n.layout{\n    color: #fff;\n    font-size: 15px;\n    /* border: 1px solid #d7dde4; */\n    position: relative;\n\tborder-radius: 4px;\n\toverflow: hidden;\n\twidth: 100%;\n\ttext-align: center;\n}\n.layout-content-center{\n    display: inline-block;\n    \n    margin-top: 10%;\n\n\tmax-width: 500px;\n}\n.qrcode{\n    display: inline-block;\n\tpadding-top: 20px;\n\n\t/* img {\n\t\twidth: 150px;\n\t\theight: 150px;\n\t\tbackground-color: #fff;\n\t\tpadding: 6px;\n\t\tbox-sizing: border-box;\n\t}; */\n}\n</style>\n<template>\n\t<div>\n\t\t<div v-show=\"showModal\" class=\"authModal\">\n\t\t\t<Modal\n\t\t\t\twidth=\"375\"\n\t\t\t\t:closable=\"false\"\n\t\t\t\tv-model=\"authModal\"\n\t\t\t\t:mask=\"true\"\n\t\t\t\t:mask-closable=\"false\"\n\t\t\t\tclass-name=\"vertical-center-modal\">\n\t\t\t\t<h4 id=\"authTitle\" style=\"text-align: center; margin-top: 5px;\">{{$t(\"lang.authTitle\")}}</h4>\n\t\t\t\t<div slot=\"footer\" style=\"text-align: center; margin-bottom: 15px;\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Row v-if=\"!authByPwd\">\n\t\t\t\t\t\t\t<Col span=\"16\">\n\t\t\t\t\t\t\t\t<Input v-model=\"authMail\" type=\"email\" :placeholder=\"$t('lang.inputEmail')\"><span slot=\"prepend\">{{$t(\"lang.email\")}}</span></Input>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t<Col span=\"4\">\n\t\t\t\t\t\t\t\t<Button id=\"authBtn\" type=\"primary\" @click=\"authCodeSend()\" style=\"margin-left: 10px\">{{$t(\"lang.sendCode\")}}</Button>\n\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t<Input v-if=\"!authByPwd\" v-model=\"authCode\" type=\"password\" :placeholder=\"$t('lang.inputCode')\" style=\"margin-top: 15px;\"><span slot=\"prepend\">{{$t(\"lang.code\")}}</span></Input>\n\t\t\t\t\t\t<Input v-if=\"authByPwd\" v-model=\"authMail\" type=\"email\" :placeholder=\"$t('lang.inputEmail')\"><span slot=\"prepend\">{{$t(\"lang.email\")}}</span></Input>\n\t\t\t\t\t\t<Input v-if=\"authByPwd\" v-model=\"authCode\" type=\"password\" :placeholder=\"$t('lang.inputCode')\"  style=\"margin-top: 15px;\"><span slot=\"prepend\">{{$t(\"lang.password\")}}</span></Input>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show=\"qrcodeImg !== ''\" style=\"text-align: center; margin-top: 15px;\">\n\t\t\t\t\t\t<img :src=\"qrcodeImg\" alt=\"qrcode-img\" />\n\t\t\t\t\t\t<!-- <div class=\"qrcode\" ref=\"qrCodeUrl\"></div> -->\n\t\t\t\t\t</div>\n\t\t\t\t\t<Button @click=\"runAuth()\" type=\"primary\" style=\"margin-top: 15px; margin-right: 10px; \">{{$t(\"lang.confirm\")}}</Button>\n\t\t\t\t\t<Button @click=\"cancelAuth(false)\" style=\"margin-top: 15px; margin-right: 10px; \">{{$t(\"lang.cancel\")}}</Button>\n\t\t\t\t\t<div class=\"layout\" style=\"margin-top: 20px\">\n\t\t\t\t\t\t<a href=\"javascript:void(0)\" @click=\"qrcodeImg = '';authByPwd = true;\" style=\"margin-right: 10px; font-size: 16px;\"><Icon type=\"md-code\" style=\"margin-right: 5px;\"/>Google</a>\n\t\t\t\t\t\t<a href=\"javascript:void(0)\" @click=\"initAuth()\" style=\"margin-right: 10px; font-size: 16px;\"><Icon type=\"md-mail\" style=\"margin-right: 5px;\"/>{{$t(\"lang.email\")}}</a>\n\t\t\t\t\t\t<a :disabled=\"qrcodeImg !== ''\" href=\"javascript:void(0)\" @click=\"initQRCodeImg()\" style=\"margin-right: 10px; font-size: 16px;\"><Icon type=\"md-qr-scanner\" style=\"margin-right: 5px;\"/>{{$t(\"lang.qrcode\")}}</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Modal>\n\t\t</div>\n\t</div>\n</template>\n<script>\n\timport {webResponse} from '../toolchain/help.js';\n    export default {\n\t\tinject: [\"reload\"],\n        data () {\n            return {\n\t\t\t\tuser: null,\n\t\t\t\tuserID: '',\n\t\t\t\tauthMail: '',\n\t\t\t\tauthCode: '',\n\t\t\t\tshowModal: false,\n\t\t\t\tauthModal: false,\n\t\t\t\tauthByPwd: false,\n\t\t\t\t\n\t\t\t\tqrcodeAuth: false,\n\t\t\t\tjustVerifyEmail: false,\n\t\t\t\t\n\t\t\t\tisPage: false,\n\t\t\t\tqrcodeImg: '',\n\t\t\t\tcodetimer: null,\n\t\t\t\tredirectUrl: '/',\n            }\n\t\t},\n\t\tprops: {\n\t\t\tonAuthSuccessed: {\n\t\t\t\ttype: Function,\n\t\t\t\tdefault: null\n\t\t\t},\n\t\t\tonUserOff: {\n\t\t\t\ttype: Function,\n\t\t\t\tdefault: null\n\t\t\t},\n\t\t},\n        mounted:function(){\n\t\t\tvar cacheEmail = localStorage.getItem('authMail');\n\t\t\tif (cacheEmail !== undefined && cacheEmail !== null && typeof(cacheEmail) === 'string') {\n\t\t\t\tthis.authMail = cacheEmail;\n\t\t\t\tconsole.log(this.authMail)\n\t\t\t}\n\t\t\tconsole.log(this.$route)\n\t\t\t\n\t\t\tif (window.location.href.indexOf('/auth') > -1) {\n\t\t\t\tthis.isPage = true;\n\t\t\t\tif (this.$route.query.redirectUrl !== undefined) this.redirectUrl = this.$route.query.redirectUrl;\n\t\t\t\tthis.runModal(this.$route.query.email)\n\t\t\t}\n        },\n        methods: {\n\t\t\tgetUser() {\n\t\t\t\treturn this.user;\n\t\t\t},\n\t\t\trunModal(email) {\n\t\t\t\tif (email !== undefined && email !== null && email !== '') this.justVerifyEmail = true;\n\t\t\t\tif (this.authMail === '') this.authMail = email;\n\t\t\t\tthis.showModal = true;\n\t\t\t\tthis.authModal = true;\n\t\t\t},\n\t\t\tcancelAuth(bSuccessed) {\n\t\t\t\tif (this.isPage === true) {\n\t\t\t\t\tif (bSuccessed === true) window.location.href = this.redirectUrl;\n\t\t\t\t} else {\n\t\t\t\t\tif (this.justVerifyEmail === false) localStorage.removeItem('isLogin');\n\t\t\t\t\tif (this.codetimer !== null) clearInterval(this.codetimer);\n\t\t\t\t\tthis.justVerifyEmail = false;\n\t\t\t\t\tthis.showModal = false;\n\t\t\t\t\tthis.authModal = false;\n\t\t\t\t\tthis.authCode = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdateUser(response) {\n\t\t\t\tlet authResult = false;\n\t\t\t\tif (response === null) {\n\t\t\t\t\tthis.user = null;\n\t\t\t\t\tlocalStorage.removeItem('authMail');\n\t\t\t\t\tif (this.onUserOff !== null && this.onUserOff !== undefined) this.onUserOff(response);\n\t\t\t\t} else {\n\t\t\t\t\tauthResult = true;\n\t\t\t\t\tthis.user = response.data['Data'];\n\t\t\t\t\tlocalStorage.setItem('isLogin', 'true');\n\t\t\t\t\tlocalStorage.setItem('authMail', this.authMail);\n\t\t\t\t\tif (this.onAuthSuccessed !== null && this.onAuthSuccessed !== undefined) this.onAuthSuccessed(response);\n\t\t\t\t}\n\t\t\t\tthis.cancelAuth(authResult);\n\t\t\t},\n\t\t\t// 这里的onUserOnline和onUserOff仅用于临时回调\n\t\t\tcheckStatus(onAuthSuccessed, onUserOff, random) {\n\t\t\t\tlet self = this;\n\t\t\t\tlet getUrl = '/api/user/status';\n\t\t\t\tif (random !== undefined && random !== null && random !== '') getUrl = getUrl + '?random=' + random;\n\t\t\t\tthis.httpGet(getUrl, function(response){\n\t\t\t\t\twebResponse(response, function(err){\n\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\tself.$Message.error(err)\n\t\t\t\t\t\tself.updateUser(null);\n\t\t\t\t\t\tif (onUserOff !== null && onUserOff !== undefined) onUserOff(response);\n\t\t\t\t\t}, function(response){\n\t\t\t\t\t\tself.updateUser(response);\n\t\t\t\t\t\tif (onAuthSuccessed !== null && onAuthSuccessed !== undefined) onAuthSuccessed(response);\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\tlogoutUser() {\n\t\t\t\tlet self = this;\n\t\t\t\tthis.httpGet('/api/user/logout', function(response){\n\t\t\t\t\tself.updateUser(null);\n\t\t\t\t}, function(response){\n\t\t\t\t\tself.updateUser(null);\n\t\t\t\t})\n\t\t\t},\n\t\t\tinitAuth() {\n\t\t\t\tthis.authByPwd = false;\n\t\t\t\tthis.qrcodeImg = '';\n\t\t\t},\n\t\t\tauthCodeSend() {\n\t\t\t\tif (this.checkAuthEmail() === false) return;\n\n\t\t\t\tlet timeCount = 0;\n\t\t\t\tdocument.getElementById(\"authBtn\").disabled = true;\n\t\t\t\tlet oldName = document.getElementById(\"authBtn\").innerHTML;\n\t\t\t\tlet timer = setInterval(()=> {\n\t\t\t\t\tif (timeCount < 60000) {\n\t\t\t\t\t\tif (document.getElementById(\"authBtn\") === undefined || document.getElementById(\"authBtn\") === null) {\n\t\t\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdocument.getElementById(\"authBtn\").innerHTML = (60000 - timeCount) / 1000 + 's ' + this.$t('lang.retry')\n\t\t\t\t\t\ttimeCount = timeCount + 1000;\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\tdocument.getElementById(\"authBtn\").disabled = false;\n\t\t\t\t\tdocument.getElementById(\"authBtn\").innerHTML = oldName;\n\t\t\t\t}, 1000)\n\n\t\t\t\tlet self = this;\n\t\t\t\tlet formdata = new FormData();\n\t\t\t\tformdata.append('kind', 'send');\n\t\t\t\tformdata.append('authID', this.authMail);\n\t\t\t\tthis.httpPost('/api/user/auth', formdata, function(response){\n\t\t\t\t\twebResponse(response, function(err){\n\t\t\t\t\t\tself.$Message.error(err)\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\trunAuth() {\n\t\t\t\tif (this.checkAuthEmail() === false) return;\n\n\t\t\t\tlet self = this;\n\t\t\t\tlet formdata = new FormData();\n\t\t\t\tlet postUrl = '/api/user/auth';\t\t\t\t\n\t\t\t\tformdata.append('kind', 'verify');\n\t\t\t\tformdata.append('authID', this.authMail);\n\t\t\t\tformdata.append('pwd', this.authCode);\n\t\t\t\tformdata.append('justVerify', this.justVerifyEmail);\n\t\t\t\tthis.httpPost(postUrl, formdata, function(response){\n\t\t\t\t\twebResponse(response, function(err){self.$Message.error(err)}, self.authSuccessed)\n\t\t\t\t})\n\t\t\t},\n\t\t\tauthSuccessed(response) {\n\t\t\t\tconsole.log(response, this.justVerifyEmail)\n\t\t\t\tthis.$Message.success(this.$t('lang.authTitle') + this.$t('lang.successed'));\n\t\t\t\tif (this.justVerifyEmail === true) {\n\t\t\t\t\tif (this.codetimer !== null) clearInterval(this.codetimer);\n\t\t\t\t\tthis.justVerifyEmail = false;\n\t\t\t\t\tthis.showModal = false;\n\t\t\t\t\tthis.authModal = false;\n\t\t\t\t\tif (this.onAuthSuccessed !== null && this.onAuthSuccessed !== undefined) this.onAuthSuccessed(response);\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.updateUser(response);\n\t\t\t},\n\t\t\tcheckAuthEmail() {\n\t\t\t\tlet authMail = this.authMail;\n\t\t\t\tif (this.authMail === undefined || this.authMail === null) authMail = '';\n\t\t\t\tlet isInvalidEmail = authMail !== '' && authMail.indexOf('@') === -1;\n\t\t\t\tif (authMail === '' || isInvalidEmail) {\n\t\t\t\t\tthis.$Message.error(this.$t('lang.inputEmail'));\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tinitQRCodeImg() {\n\t\t\t\tif (this.checkAuthEmail() === false) return;\n\n\t\t\t\tlet self = this;\n\t\t\t\tlet formdata = new FormData();\n\t\t\t\tformdata.append('kind', 'qrcode');\n\t\t\t\tformdata.append('authID', this.authMail);\n\t\t\t\tthis.httpPost('/api/user/auth', formdata, function(response){\n\t\t\t\t\twebResponse(response, function(err){self.$Message.error(err)}, self.updateQRCodeImg)\n\t\t\t\t})\n\t\t\t},\n\t\t\tupdateQRCodeImg(response) {\n\t\t\t\tthis.qrcodeImg = response.data['Data'];\n\t\t\t},\n\t\t\thttpGet(url, onResponse, onPanic) {\n\t\t\t\tthis.$axios.get(url)\n\t\t\t\t.then(function (response) {\n\t\t\t\t\tif (onResponse !== undefined && onResponse !== null) onResponse(response);\n\t\t\t\t})\n\t\t\t\t.catch(function (response) {\n\t\t\t\t\tif (onPanic !== undefined && onPanic !== null) onPanic(response);\n\t\t\t\t});\n\t\t\t},\n\t\t\thttpPost(url, formdata, onResponse, onPanic) {\n\t\t\t\tthis.$axios.post(url, formdata)\n\t\t\t\t.then(function (response) {\n\t\t\t\t\tif (onResponse !== undefined && onResponse !== null) onResponse(response);\n\t\t\t\t})\n\t\t\t\t.catch(function (response) {\n\t\t\t\t\tif (onPanic !== undefined && onPanic !== null) onPanic(response);\n\t\t\t\t});\n\t\t\t}\n        }\n    }\n    </script>"]}]}